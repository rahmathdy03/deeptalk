<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DeepTalk Night ‚ú®</title>

<style>
* { box-sizing: border-box; }

body {
margin: 0;
height: 100vh;
font-family: 'Poppins', sans-serif;
color: #fff;
overflow: hidden;
}

/* ===== OPENING ===== */
#opening {
position: fixed;
inset: 0;
background:
linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)),
url('bgawal.jpg') center/cover no-repeat;
display: flex;
justify-content: center;
align-items: center;
text-align: center;
z-index: 10;
}

#opening button {
margin-top: 24px;
padding: 12px 28px;
border-radius: 30px;
border: none;
font-size: 1rem;
cursor: pointer;
}

/* ===== MAIN ===== */
#main {
display: none;
height: 100vh;
background:
linear-gradient(rgba(0,0,0,0.55), rgba(0,0,0,0.55)),
url('bg.jpg') center/cover no-repeat;
display: flex;
justify-content: center;
align-items: center;
}

.container {
text-align: center;
padding: 20px;
}

/* CARD */
.card {
width: 300px;
height: 190px;
perspective: 1200px;
margin: 24px auto;
cursor: pointer;
}

.card-inner {
width: 100%;
height: 100%;
transform-style: preserve-3d;
transition: transform 0.8s;
position: relative;
}

.card.flip .card-inner {
transform: rotateY(180deg);
}

.card-face {
position: absolute;
width: 100%;
height: 100%;
border-radius: 18px;
backface-visibility: hidden;
display: flex;
align-items: center;
justify-content: center;
padding: 18px;
box-shadow: 0 15px 35px rgba(0,0,0,0.4);
}

.front {
background: linear-gradient(135deg, #ffafbd, #ffc3a0);
color: #333;
font-weight: 600;
}

.back {
background: linear-gradient(135deg, #667eea, #764ba2);
transform: rotateY(180deg);
}

/* BUTTON */
button {
padding: 10px 22px;
border-radius: 25px;
border: none;
cursor: pointer;
}

/* INFO */
#message { margin-top: 10px; color: #ffd36e; }
#counter { margin-top: 6px; font-size: 0.9rem; opacity: 0.9; }

/* CLOCK */
.clock {
position: fixed;
bottom: 16px;
right: 16px;
padding: 10px 16px;
border-radius: 14px;
background: rgba(0,0,0,0.55);
font-family: monospace;
font-size: 1.05rem;
color: #ffd36e;
box-shadow: 0 0 15px rgba(255,211,110,0.5);
}

/* WISHLIST */
#wishlist { display: none; }
textarea {
width: 90%;
max-width: 320px;
height: 80px;
border-radius: 14px;
border: none;
padding: 10px;
margin: 8px 0;
}

/* CAMERA */
#cameraScreen, #resultScreen {
display: none;
text-align: center;
padding: 20px;
}

video {
width: 90%;
max-width: 320px;
border-radius: 18px;
}

img {
width: 90%;
max-width: 360px;
border-radius: 22px;
box-shadow: 0 15px 40px rgba(0,0,0,0.45);
}
</style>
</head>

<body>

<!-- OPENING -->
<div id="opening">
  <div>
    <h1>Malam ini cuma tentang kita</h1>
    <button onclick="start()">Tap to Start</button>
  </div>
</div>

<!-- MAIN -->
<div id="main">
<div class="container">
<h1>üåô DeepTalk Night</h1>

<div class="card" onclick="flipCard()">
  <div class="card-inner">
    <div class="card-face front">üé¥ Tap untuk membuka</div>
    <div class="card-face back" id="question">...</div>
  </div>
</div>

<button onclick="nextCard()">Kartu Berikutnya</button>
<div id="counter">Kartu 0 / 10</div>
<div id="message"></div>

<div id="wishlist">
<h2>Wishlist 2026 ü§ç</h2>
<textarea id="rahmat" placeholder="Rahmat ingin..."></textarea>
<textarea id="finka" placeholder="Finka ingin..."></textarea><br>
<button onclick="startCamera()">Aamiin ü§ç</button>
</div>
</div>
</div>

<div class="clock" id="clock">00:00:00</div>

<!-- CAMERA -->
<div id="cameraScreen">
<h2>üì∏ Simpan Doa Kita</h2>
<video id="video" autoplay playsinline></video><br><br>
<button onclick="takePhotoMulti()">Ambil Foto</button>
<p id="photoInfo">Foto 1 dari 3</p>
</div>

<!-- RESULT -->
<canvas id="canvas" style="display:none"></canvas>
<div id="resultScreen">
<h2>Wishlist Kita 2026</h2>
<img id="finalImg"><br><br>
<a id="download" download="wishlist-2026.png">
<button>Simpan Kenangan</button>
</a>
</div>

<script>
const questions = [
"Apa momen paling sederhana bersamaku yang ternyata paling kamu ingat sampai sekarang?",
"Menurutmu, seperti apa cinta yang ingin kamu pertahankan sampai tua nanti?",
"Hal apa tentang dirimu yang jarang kamu ceritakan ke orang lain, tapi ingin aku tahu?",
"Apa hal tentang aku yang baru kamu sadari setelah kita pacaran?",
"Apa yang paling kamu harapkan dari aku saat kamu capek?",
"Menurut kamu apa kekuatan terbesar hubungan kita?",
"Apa yang ingin kita perbaiki di tahun depan?",
"Pernah ngga merasa takut kehilangan aku?",
"Apa arti komitmen buat kamu sekarang?",
"Satu harapan jujur untuk kita tahun depan?"
];

let i = 0;
let stream;

/* OPEN */
function start(){
opening.style.display="none";
main.style.display="flex";
}

/* CARD */
function flipCard(){
document.querySelector(".card").classList.toggle("flip");
}

function nextCard(){
document.querySelector(".card").classList.remove("flip");
question.innerText = questions[i];
counter.innerText = `Kartu ${i+1} / 10`;

if(i===2) message.innerText="ü§ç Pegangan tangan 10 detik";
else if(i===6) message.innerText="üòä Patpat kepala 3 kali";
else message.innerText="";

i++;
if(i===10) setTimeout(()=>wishlist.style.display="block",800);
}

/* CLOCK */
setInterval(()=>{
const d=new Date();
clock.innerText=
`${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}:${String(d.getSeconds()).padStart(2,'0')}`;
},1000);

/* CAMERA */
let photoCount = 0;
const photos = [];

function startCamera(){
main.style.display="none";
cameraScreen.style.display="block";
navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}})
.then(s=>{stream=s;video.srcObject=s;});
}

function takePhotoMulti(){
const temp=document.createElement("canvas");
temp.width=480;
temp.height=640;
temp.getContext("2d").drawImage(video,0,0,480,640);
photos.push(temp);
photoCount++;
photoInfo.innerText=`Foto ${photoCount} dari 3`;

if(photoCount===3){
stream.getTracks().forEach(t=>t.stop());
renderFinal();
}
}

function renderFinal(){
cameraScreen.style.display="none";
resultScreen.style.display="block";

const bg=new Image();
bg.src="pb.jpg";

bg.onload=()=>{
canvas.width=bg.width;
canvas.height=bg.height;
const ctx=canvas.getContext("2d");
ctx.drawImage(bg,0,0);

const frames=[
{x:80,y:140,w:920,h:320},
{x:80,y:520,w:920,h:320},
{x:80,y:900,w:920,h:320}
];

photos.forEach((p,i)=>{
ctx.save();
ctx.beginPath();
ctx.roundRect(frames[i].x,frames[i].y,frames[i].w,frames[i].h,28);
ctx.clip();
ctx.drawImage(p,frames[i].x,frames[i].y,frames[i].w,frames[i].h);
ctx.restore();
});

ctx.fillStyle="#4a4a4a";
ctx.font="bold 42px Poppins";
ctx.textAlign="center";
ctx.fillText("Wishlist Kita 2026",canvas.width/2,1300);

ctx.font="30px Poppins";
ctx.textAlign="left";
ctx.fillText("Rahmat:",100,1360);
ctx.fillText(rahmat.value,100,1400);
ctx.fillText("Finka:",100,1500);
ctx.fillText(finka.value,100,1540);

finalImg.src=canvas.toDataURL();
download.href=finalImg.src;
};
}
</script>

</body>
</html>
